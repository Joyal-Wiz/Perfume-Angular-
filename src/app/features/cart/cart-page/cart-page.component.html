<!-- HTML Template -->
<div class="cart-page">

  <!-- HEADER SECTION -->
  <div class="cart-header">
    <div class="header-content">
      <div class="title-section">
        <h2 class="cart-title">Shopping Cart</h2>
        <p class="cart-subtitle">{{ cartItems.length }} items in your cart</p>
      </div>
      <button class="continue-shopping" routerLink="/products">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="15 18 9 12 15 6"/>
        </svg>
        Continue Shopping
      </button>
    </div>
  </div>

  <div class="cart-container" *ngIf="cartItems.length > 0; else emptyCart">

    <!-- LEFT SIDE: CART ITEMS -->
    <div class="cart-items">

      <!-- Progress Bar -->
      <div class="free-shipping-banner">
        <div class="banner-content">
          <div class="banner-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="1" y="3" width="15" height="13"/>
              <polygon points="16 8 20 8 23 11 23 16 16 16 16 8"/>
              <circle cx="5.5" cy="18.5" r="2.5"/>
              <circle cx="18.5" cy="18.5" r="2.5"/>
            </svg>
          </div>
          <div class="banner-text">
            <p class="banner-title">You're ‚Çπ{{ (5000 - getTotal()).toFixed(2) }} away from FREE shipping!</p>
            <div class="progress-bar">
              <div class="progress-fill" [style.width.%]="(getTotal() / 5000) * 100"></div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Cart Items List -->
      <div class="cart-item" *ngFor="let item of cartItems">
        
        <!-- Product Image -->
        <div class="item-image-wrapper">
          <img [src]="item.image" class="item-img" alt="product">
          <div class="discount-badge" *ngIf="item.discount > 0">
            -{{ item.discount }}%
          </div>
        </div>

        <!-- Product Details -->
        <div class="item-details">
          <div class="item-header">
            <div>
              <h3 class="item-name">{{ item.name }}</h3>
              <p class="brand">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M20 7h-9M14 3v4M6 21V10a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v11"/>
                </svg>
                {{ item.brand }}
              </p>
            </div>
            <button class="wishlist-btn" >
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>
              </svg>
            </button>
          </div>

          <!-- Price Section -->
          <div class="price-section">
            <div class="price-wrapper">
              <span class="final-price">
                ‚Çπ{{ (item.price - (item.price * item.discount / 100)).toFixed(2) }}
              </span>
              <span class="old-price" *ngIf="item.discount > 0">‚Çπ{{ item.price.toFixed(2) }}</span>
            </div>
            <div class="savings" *ngIf="item.discount > 0">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"/>
                <line x1="7" y1="7" x2="7.01" y2="7"/>
              </svg>
              You save ‚Çπ{{ ((item.price * item.discount / 100) * item.quantity).toFixed(2) }}
            </div>
          </div>

          <!-- Stock Alert -->
          <div class="stock-alert" *ngIf="item.stock <= 3">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/>
              <line x1="12" y1="9" x2="12" y2="13"/>
              <line x1="12" y1="17" x2="12.01" y2="17"/>
            </svg>
            Only {{ item.stock }} left in stock!
          </div>

          <!-- Actions Row -->
          <div class="actions-row">
            <!-- Quantity Box -->
            <div class="qty-box">
              <button class="qty-btn" (click)="decrease(item)">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <line x1="5" y1="12" x2="19" y2="12"/>
                </svg>
              </button>
              <span class="qty-value">{{ item.quantity }}</span>
              <button class="qty-btn" (click)="increase(item)">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <line x1="12" y1="5" x2="12" y2="19"/>
                  <line x1="5" y1="12" x2="19" y2="12"/>
                </svg>
              </button>
            </div>

            <!-- Item Total -->
            <div class="item-total">
              <span class="total-label">Total:</span>
              <span class="total-price">
                ‚Çπ{{ ((item.price - (item.price * item.discount / 100)) * item.quantity).toFixed(2) }}
              </span>
            </div>

            <!-- Remove Button -->
            <button class="remove-btn" (click)="removeItem(item.id)">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="3 6 5 6 21 6"/>
                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
              </svg>
              Remove
            </button>
          </div>

        </div>

      </div>

      

    </div>

    <!-- RIGHT SIDE: PRICE SUMMARY -->
    <div class="summary-sidebar">



      <!-- Summary Box -->
      <div class="summary-box">
        <h3 class="summary-header">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="12" y1="1" x2="12" y2="23"/>
            <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
          </svg>
          Order Summary
        </h3>

        <!-- Item Details -->
        <div class="summary-items">
          <div class="summary-item" *ngFor="let item of cartItems">
            <div class="summary-item-header">
              <span class="item-summary-name">{{ item.name }}</span>
              <span class="item-summary-qty">√ó{{ item.quantity }}</span>
            </div>
            <div class="summary-item-price">
              <span>‚Çπ{{ ((item.price - (item.price * item.discount / 100)) * item.quantity).toFixed(2) }}</span>
              <span class="item-saved" *ngIf="item.discount > 0">
                -‚Çπ{{ ((item.price * item.discount / 100) * item.quantity).toFixed(2) }}
              </span>
            </div>
          </div>
        </div>

        <div class="summary-divider"></div>


        <!-- Discount -->
        <div class="summary-row discount-row">
          <span>
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"/>
              <line x1="7" y1="7" x2="7.01" y2="7"/>
            </svg>
            Total Discount
          </span>
          <span class="discount-value">-‚Çπ{{ getTotalDiscount().toFixed(2) }}</span>
        </div>

        <!-- Shipping -->
        <div class="summary-row">
          <span>Shipping Fee</span>
          <span class="free-text">FREE</span>
        </div>

        <!-- Tax -->
        <div class="summary-row">
          <span>Tax (GST 18%)</span>
          <span>‚Çπ{{ (getTotal() * 0.18).toFixed(2) }}</span>
        </div>

        <div class="summary-divider-thick"></div>

        <!-- Grand Total -->
        <div class="summary-row total-row">
          <span>Grand Total</span>
          <span>‚Çπ{{ (getTotal() * 1.18).toFixed(2) }}</span>
        </div>

        <!-- Checkout Button -->
        <button class="checkout-btn" (click)="buyNow()">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M5 12h14M12 5l7 7-7 7"/>
          </svg>
          Proceed to Checkout
        </button>

        <!-- Trust Badges -->
        <div class="trust-badges">
          <div class="trust-item">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
            </svg>
            <span>Secure Payment</span>
          </div>
          <div class="trust-item">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="20 6 9 17 4 12"/>
            </svg>
            <span>100% Authentic</span>
          </div>
        </div>
      </div>

      <!-- Payment Methods -->
      <div class="payment-methods">
        <h4>We Accept</h4>
        <div class="payment-icons">
          <div class="payment-icon">üí≥</div>
          <div class="payment-icon">üè¶</div>
          <div class="payment-icon">üì±</div>
          <div class="payment-icon">üí∞</div>
        </div>
      </div>

    </div>

  </div>

  <!-- EMPTY CART MESSAGE -->
  <ng-template #emptyCart>
    <div class="empty-cart">
      <div class="empty-icon">
        <svg width="100" height="100" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
          <circle cx="9" cy="21" r="1"/>
          <circle cx="20" cy="21" r="1"/>
          <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/>
        </svg>
      </div>
      <h3>Your Cart is Empty</h3>
      <p>Looks like you haven't added anything to your cart yet</p>
      <button class="shop-now-btn" routerLink="/products">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="9" cy="21" r="1"/>
          <circle cx="20" cy="21" r="1"/>
          <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/>
        </svg>
        Start Shopping
      </button>
    </div>
  </ng-template>

</div>


