<!-- HTML Template -->
<div class="details-container" *ngIf="product">

  <!-- LEFT: IMAGE SECTION -->
  <div class="left">
    <div class="image-wrapper" [ngStyle]="{bottom: role === 'admin' ? '2em' : '21em'}">
      
      <div class="offer-badge" *ngIf="product.discount">
        <span class="badge-text">-{{ product.discount }}%</span>
        <span class="badge-subtext">OFF</span>
      </div>

      <div class="image-glow"></div>

      <img [src]="product.image" class="main-image" alt="product-image">

      <div class="floating-elements">
        <div class="float-circle circle-1"></div>
        <div class="float-circle circle-2"></div>
        <div class="float-circle circle-3"></div>
      </div>

    </div>
  </div>

  <!-- RIGHT: PRODUCT INFO -->
  <div class="right">

    <!-- BRAND TAG -->
    <div class="brand-tag">
      <svg width="16" height="16" viewBox="0 0 24 24">
        <path d="M20 7h-9M14 3v4M6 21V10a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v11"/>
      </svg>
      {{ product.brand }}
    </div>

    <!-- TITLE -->
    <h1 class="title">{{ product.name }}</h1>

    <!-- CATEGORY + RATING -->
    <div class="category-rating-row">
      <div class="category-chip">
        <svg width="14" height="14" viewBox="0 0 24 24">
          <rect x="3" y="3" width="7" height="7"/>
          <rect x="14" y="3" width="7" height="7"/>
          <rect x="14" y="14" width="7" height="7"/>
          <rect x="3" y="14" width="7" height="7"/>
        </svg>
        {{ product.category }}
      </div>

      <div class="rating-display">
        <div class="stars">
          <span class="star filled">â˜…</span>
          <span class="star filled">â˜…</span>
          <span class="star filled">â˜…</span>
          <span class="star filled">â˜…</span>
          <span class="star half">â˜…</span>
        </div>
        <span class="rating-text">4.5 (234 reviews)</span>
      </div>
    </div>

    <!-- PRICE -->
    <div class="price-section">
      <div class="price-wrapper">
        <span class="currency">â‚¹</span>
        <span class="price">
          {{ (product.price - (product.price * product.discount / 100)).toFixed(2) }}
        </span>
      </div>

      <div class="price-details" *ngIf="product.discount">
        <span class="old-price">â‚¹{{ product.price }}</span>
        <span class="save-badge">
          Save â‚¹{{ (product.price * product.discount / 100).toFixed(2) }}
        </span>
      </div>
    </div>

    <!-- DESCRIPTION -->
    <div class="description-card">
      <div class="desc-header">
        <svg width="20" height="20" viewBox="0 0 24 24">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
        </svg>
        <h3>Product Description</h3>
      </div>

      <p class="desc-text">
        Indulge in the luxurious aroma of <strong>{{ product.name }}</strong>. Crafted with
        premium notes and long-lasting fragrance, this perfume is perfect for any occasion.
      </p>
    </div>

    <!-- FEATURES (Hidden for Admin) -->
    <div class="features-grid" *ngIf="!isAdmin()">
      <div class="feature-item">
        <div class="feature-icon">
          <svg width="20" height="20" viewBox="0 0 24 24">
            <path d="M12 2v20M2 12h20"/>
          </svg>
        </div>
        <div class="feature-content">
          <span class="feature-title">Premium Quality</span>
        </div>
      </div>

      <div class="feature-item">
        <div class="feature-icon">
          <svg width="20" height="20" viewBox="0 0 24 24">
            <circle cx="12" cy="12" r="10"/>
          </svg>
        </div>
        <div class="feature-content">
          <span class="feature-title">Long Lasting</span>
        </div>
      </div>

      <div class="feature-item">
        <div class="feature-icon">
          <svg width="20" height="20" viewBox="0 0 24 24">
            <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/>
          </svg>
        </div>
        <div class="feature-content">
          <span class="feature-title">Unique Scent</span>
        </div>
      </div>
    </div>

    <!-- SPECIAL OFFER -->
    <div class="special-offer" *ngIf="product.discount > 0 && !isAdmin()">
      <div class="offer-icon">âš¡</div>
      <div class="offer-content">
        <strong>Limited Time Offer</strong>
        <p>Save {{ product.discount }}% on this exclusive item</p>
      </div>
    </div>

    <!-- STOCK -->
    <div class="stock-section">
      <div class="stock-indicator"
        [class.low-stock]="product.stock > 0 && product.stock < 5"
        [class.out-of-stock]="product.stock === 0">
        <div class="stock-dot"></div>
        <span class="stock-text">
          {{ product.stock === 0 ? "Out of Stock" :
             product.stock < 5 ? "Only " + product.stock + " left!" :
             product.stock + " items available" }}
        </span>
      </div>
    </div>

    <!-- USER ACTION BUTTONS -->
    <div class="action-buttons" *ngIf="role !== 'admin'">
      <button class="add-btn" [disabled]="product.stock === 0" (click)="addToCart()">
        Add to Cart
      </button>

      <button class="buy-btn" [disabled]="product.stock === 0" (click)="buyNow()">
        Buy Now
      </button>
    </div>

    <!-- ADMIN ACTIONS -->
    <div *ngIf="role === 'admin'" class="admin-actions">
      <button class="edit-btn" (click)="editProduct()">Edit</button>
      <button class="delete-btn" (click)="showDeleteConfirm = true">ðŸ—‘ Delete</button>
    </div>

  </div>
</div>

<!-- DELETE CONFIRM MODAL -->
<app-confirmation-modal
  *ngIf="showDeleteConfirm"
  message="Are you sure you want to delete this product?"
  (confirm)="deleteProduct()"
  (cancel)="showDeleteConfirm = false">
</app-confirmation-modal>
